
<!DOCTYPE html>
<html>
	<head>
		<style>
body {
	background: #eee;
	color: #222;
	font-family: Arial;
}
.container {
	margin: auto;
	background: #fff;
	height: 650px;
	width: 80%;
	text-align: center;
}

.container .header {
	padding: 20px 0;
}
.container input{
	border: none;
}
		</style>
	</head>
	<body>
		<div id="HEHEoverlay" style="position:fixed;left:0;top:0;width:100%;bottom:0;font-size:50px">
			<span id="hehehehehe"></span>
		</div>
		<div class="container">
			<div class="header">
				<h1> GCal AutoGenerator v1.0 </h1>
			</div>
<span>(1) Download timetable page from UTAR Portal. (right-click > Save as...)<br><br>
(2) Upload UTAR Intranet_files/index.html here:</span>
<br><br><input type="file" name="in_file" id="in_file" style="
    width: 100%;
    height: 100%;
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
">
<br><br>(3) Your file will be downloaded shortly.
<br><i>Can't download the file? Copy the following code and save it as June2022.ics .</i>
<br><br>
<textarea id="result" type="text" wrap="soft" style="width:250px;height:150px;cursor:pointer;display:none;margin:auto" readonly onclick="myFunction(this)"></textarea>
		</div>

		<div id="view"></div>
		<script>
document.getElementById('in_file').addEventListener('change', function() {
	var fin = new FileReader();
    fin.onload = function(){
	    
    document.getElementById('view').innerHTML = fin.result;
	    var courseID = document.getElementById('view').getElementsByTagName("title")[0].innerText.split(" ")[1];
	var total =document.getElementsByClassName("weeks")[0].offsetHeight;
	if (getCookie(courseID) != total)
	{
		document.getElementById("hehehehehe").innerHTML += ((parseInt(total) - parseInt(getCookie(courseID))) + " resources is just added to "+courseID+". Please take note!<br><br>");
		document.cookie = courseID+"="+total+"; expires=Sat, 31 Dec 2022 12:00:00 UTC; path=/";
	}
	    var arr = ["MPU34112","UAMG1043","UCCC2063","UCCD2044","UCCD2063","UCCD2323"];
	    for(var i = 1; i <= 5; i++)
	    {
		    document.getElementById("hehehehehe").innerHTML += arr[i] + ": " +  getCookie(arr[i]) + "<br>";
	    }
    }
              
    fin.readAsText(this.files[0]);
});
			
function getCookie(name) {
  name += "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (!c.indexOf(name)) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
			
function myFunction(copyText) {
	copyText.select();
	navigator.clipboard.writeText(copyText.value);
	alert("File copied!");
}

		</script>
	</body>
</html>
